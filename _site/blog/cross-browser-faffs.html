<!doctype html>
<html>
<head>
  <title>Tim Douglas | Cross Browser Faffing</title>
  <!-- metas -->
  <meta name="charset" content="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="author" content="Tim Douglas">
  <meta name="description" content="The place on the web for all things Tim Douglas">
  

  <!--[if lt IE 9]>
  <script src="/js/html5shiv.js"></script>
  <script src="/js/shim.min.js"></script>
  <![endif]-->

  <!-- css -->
  
  <link href="/css/main.css" type="text/css" rel="stylesheet" />
  
</head>
<body>
  <div class="page-wrapper">
    <div class="side">
      <header class="page-head">
        <h1>Tim Douglas</h1>
      </header>
      <p>
        <a href="/" class="main-img-link">
          <img src="http://www.gravatar.com/avatar/4f583d67bb3e446afb115079b08cff00?s=200" alt="Photo of me" />
        </a>
      </p>
      <p>Bath and Bristol-based Web Developer. Rugby fan. Geek.</p>
      <ul class="social">
        <li><a href="http://twitter.com/timdouglas"><span class="entypo-twitter"></span></a></li>
        <li><a href="http://plus.google.com/u/0/115974445446390686527"><span class="entypo-gplus"></span></a></li>
        <li><a href="http://github.com/timdouglas"><span class="entypo-github"></span></a></li>
        <li><a href="http://uk.linkedin.com/in/tsdouglas/"><span class="entypo-linkedin"></span></a></li>
      </ul>
      <nav>
        <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/about.html">About Me</a></li>
          <li><a href="/posts.html">Posts</a></li>
          <li><a href="/projects.html">Projects</a></li>
          <li><a href="/contact.html">Contact</a></li>
        </ul>
      </nav>
    </div>
    <div class="page">
      <!--[if lt IE 7]>
        <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
      <![endif]-->
      <div class="content">
        <header class="welcome">
  <h1>Cross Browser Faffing</h1>
  <p>
    <div class="post-meta">
      <span class="post-date">30 May 2013</span>
      Tags: <span class="post-tags">web and dev</span>
    </div>
  </p>
</header>

<article class="post">
  <p><img src='/imgs/broken.png' alt='Broken IE7' /></p>

<p>Recently I was playing about with <a href='http://www.browserstack.com'>BrowserStack</a> (which is worth its weight in gold frankly) and noticed that this site was fairly crappily supported in older browsers. I&#8217;m talking IE7 and under, FF3 on Windows XP etc etc. And it wasn&#8217;t just styles broken, the js loading my <a href='/projects.html'>projects list</a> was also pretty b0rked.</p>

<p>So instead of not caring, I decided to attempt to fix it. This is what happened</p>

<h2 id='the_styling'>The Styling</h2>

<p>As you can see from the screenshot above, IE doesn&#8217;t like much of my site, so the first thing I did was add some conditional comments into the default template to include <a href='http://code.google.com/p/html5shiv'>HTML5 Shiv</a> which adds the new html5 elements to IE, as well as default styling for them (nice touch).</p>

<p>I then added polyfills for <a href='https://code.google.com/p/css3-mediaqueries-js/'>media queries</a> and <a href='https://github.com/albertogasparin/borderBoxModel'>box-sizing</a>, and merged them into a single file to save an HTTP request.</p>

<p>Things were looking a bit better, but I still had to fix the floating issue. After a bit of head scratching I resorted to using selector hacks to adjust the sizes on IE7 and IE6. It&#8217;s a bit of a dirty thing to do, but it worked&#8230;</p>

<h2 id='the_javascript'>The Javascript</h2>

<p>The github projects plugin I&#8217;d modified had ECMASCRIPT5 functions in it which were breaking the older browsers, luckily it also broke non-IE browers, so at least I could use some decent debugging tools to find it out!</p>

<p>There was a wide range of things missing, such as <code>Array.isArray</code> and <code>Array.forEach</code>, so instead of including the prototypes for each missing function, I decided to use <a href='http://yepnopejs.com'>yepnope</a> to load a polyfill with them all in. After a bit of research, I decided to use <a href='https://github.com/kriskowal/es5-shim'>es5-shim</a>. However I didn&#8217;t want to load it into the page willynilly, so I wrote a small module wrapper to load the github projects page:</p>
<pre>
  <code class='language-javascript'>
var GithubProjects = (function(yepnope)
{
  "use strict";
  
  var self =
  {
    init: function()
    {
      //run yepnope tests and loads
      yepnope(
      [
        {
          test: Array.isArray, //basic requirement for jquery.github.js
          nope: "/js/es5-shim.min.js",
        },
        {
          test: window.JSON, //needed to read the github api response
          nope: "/js/json2.min.js"
        },
        {
          test: window.jQuery, //needed for dom manipulation in github plugin
          nope: ["https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js", "/js/jquery.github.min.js"],
          yep: "/js/jquery.github.min.js", //if jquery already present, just load plugin
          complete: function()
          {
            //call the plugin
            self.github(window.jQuery);
          }
        }        
      ]);
    },

    github: function($)
    {
      //only want this to run on DOM ready, so wrap it just to be sure
      $(function(){ $("section.projects").github({ username: "timdouglas" }); });
    }
  };

  return self;
})(yepnope);
  </code>
</pre>
<p>It&#8217;s then a simple case of just calling <code>GithubProjects.init()</code> on the projects page and all the dependecies are loaded before the plugin is executed.</p>

<h2 id='what_i_learned'>What I learned</h2>

<p>So yeah, I probably should&#8217;ve checked older-browser compatibility a long time ago, but better late than never, eh? Since the browsers themselves have started updating properly, people aren&#8217;t getting left behind so much, and so nobody has actually viewed this site on an older browser - but of course that doesn&#8217;t mean nobody will. And it also means that without BrowserStack, I&#8217;d have been completely unaware until that time.</p>

<p>I also came across some good resources for cross-browser polyfills and hacks:</p>

<ul>
<li>This <a href='https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills'>list</a> from Modernizr was fantasticly useful.</li>

<li><a href='http://browserhacks.com/'>BrowserHacks</a> for the styling hacks</li>

<li>The <a href='http://yepnopejs.com/'>Yepnope</a> documentation is great.</li>
</ul>
</article>

<nav class="post-navigation">
  <div class="left"> 
     
    <a href="/blog/podcasts.html" title="Previous Post: Podcasts">&laquo; Podcasts</a> 
     
  </div> 
  <div class="right"> 
     
  </div> 
</nav> 
      </div>
    </div>
  </div>
  <footer class="page-foot">&copy; Tim Douglas 2013</footer>
  
  <script src="/js/prism.js"></script>
  
  <script>
    window.onscroll = function()
    {
      var scroll = window.pageYOffset,
        ela = document.getElementsByClassName("main-img-link")[0],
        img = ela.getElementsByTagName("img")[0],
        style = img.style,
        pc_rotate = (scroll / 275) * 100,
        new_rotate = (pc_rotate > 90 ? 90 : pc_rotate) * -1,
        rotate_str = "rotate("+new_rotate+"deg)";

      style.webkitTransform = rotate_str;
      style.mozTransform = rotate_str;
      style.oTransform = rotate_str;
      style.msTransform = rotate_str;
      style.transform = rotate_str;
    };

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-34112993-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
</body>
</html>